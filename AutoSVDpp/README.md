# AutoSVD++: An Efficient Hybrid Collaborative Filtering Model via Contractive Auto-encoders

## What we've used and modified
We've used the same model architecture for AutoSVD and AutoSVD++ from:
AutoSVD++ paper: https://github.com/cheungdaven/autosvdpp/tree/master

We've changed and added:
- Data: Generated subset of Yelp dataset
- Data loader for Yelp: ./utils/LoadDataSet.py
  - Original model built for MovieLens 100k and MovieLens 1M datasets. In order to get the recommendation for restaurant, we reimplemented the data loader to have the same input format: userID\t itemID\t rating\t timestamp (optional)
- Feature representation via Contractive AntoEncoders: ./utils/ContractiveAutoEnconder.py
  - Extracted restaurant features: ./datasets/samplesets/restaurant_features_encoded.csv
- Yelp recommendation generator: ./utils/YelpRecommendationGenerator.py
  - Randomly generate a sample user, predict the ratings that the user will give to each business, and provides top-k recommendations 
- Training and analysis code: Training.ipynb
  - Build and train AutoSVD and AutoSVD++: main_AutoSVD.py and main_AutoSVDpp.py
- Inferencing and evaluation code: Inference.ipynb
  - Load pretrained AutoSVD and AutoSVD++ and make predictions and recommendations: predict_AutoSVD.py and predict_AutoSVDpp.py
- Training configuration such as training hyperparameters and evaluation metrics: ./parameters/

## Training and Inference Data Statistics

### Training data

| Model            | CAE              | AutoSVD    | AutoSVD++  |
|------------------|------------------|------------|------------|
| Completion Time  |   8min 36s       | 2min 26s   | 3min 52s   |

CAE Loss Curve \
<img src="pic/CAE_Loss.png" alt="cae loss" style="width:225px;height:150px;">

Testing data

Two different evaluation dataset for the NCF model. The first evaluation is done while training, the test/train split is 0.2. 
Second evaluation is done with the test subset generated by our group.

First Evaluation

Model trained with 1k users (500 epochs)

Loss Curve 
1k loss

Hit Rate: 0.7447 
1k HR

NDCG: 0.3877 
1k NDCG

Model trained with 5k users (100 epochs)

Loss Curve 
5k loss

Hit Rate: 0.7227 
5k HR

NDCG: 0.3547 
5k NDCG

Second Evaluation

With the test subset generated by our group.

Total User	Tested User	Missed User	True Predction	Evaluation Time
5828	1325	4503	0	3h 5m
